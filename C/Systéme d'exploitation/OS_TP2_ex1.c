#include <stdio.h> // p r i n t f ( . . )
#include <stdlib.h> // EXIT_SUCCESS
#include <signal.h> // s i g n a l ( . . )
#include <unistd.h>

#define TERMINATE 0
#define CONTINUE 1
unsigned int behavior = CONTINUE;
unsigned int sigusr1_count = 0;

// Handler des signaux
void handler(int signum) {
    if (signum == SIGUSR1) {
        printf("Caught a SIGUSR1 signal.\tHELLO\n");
        fflush(stdout);
        sigusr1_count++;
    }
    else if (signum == SIGUSR2) {
        printf("Caught a SIGUSR2 signal.\t%u\n", sigusr1_count);
        fflush(stdout);
        behavior = TERMINATE;
    }
}

int main(int argc, char *argv[]) {
    // Associer les signaux aux handlers
    signal(SIGUSR1, handler);
    signal(SIGUSR2, handler);

    // Afficher le PID pour envoyer les signaux avec kill
    printf("My pid is : %ld\n", (long)getpid());

    // Boucle infinie en attente de signaux
    while (behavior == CONTINUE) {
        pause(); // attendre un signal
        printf("Waiting loop resumed.\n");
    }

    return EXIT_SUCCESS;
}
